import{r as react,R as React,g as getAugmentedNamespace,f as Link,S as Switch,b as Route}from"./vendor.454eb9d5.js";import{s as storeResolveState,t as transform,a as storeProcessedState,R as ReportErrorUri}from"./index.ea9ef89d.js";import{p as pako_1}from"./index.baf24c9e.js";function generatePrefixList(o){const e={};for(const r of o){const t=r.split("/");let s=t[0]+"/";for(const i of t.slice(1))e[s+i]=e[s+i]||0,e[s+i]++,s=s+i+"/"}let n=[];for(const r of Object.keys(e))n.push({prefix:r,count:e[r]});return n.sort((r,t)=>t.count-r.count)}function findTrims(o,e){const n=generatePrefixList(o),r=generatePrefixList(e),t={};for(let s=0;s<n.length;s++)for(let i=0;i<r.length;i++)if(n[s].prefix.length>r[i].prefix.length){const u=n[s].prefix.indexOf(r[i].prefix);if(u>-1){const a=n[s].prefix.slice(0,u);a!==""&&(t[a]=t[a]||0,t[a]++)}}else{const u=r[i].prefix.indexOf(n[s].prefix);if(u>-1){const a=r[i].prefix.slice(0,u);a!==""&&(t[a]=t[a]||0,t[a]++)}}for(const s of Object.keys(t))for(const i of Object.keys(t))i.startsWith(s)&&i!==s&&delete t[i];return t}function toFunctionRef(func){let ref;try{ref=eval(`(${func})`)}catch(o){alert(`unable to compile transform due to ${o}`)}return ref}function transformGraphNames(o,e,n){return o.map(r=>(r.source=e(trimClean(n,r.source)),r.target!=null&&(r.target=e(trimClean(n,r.target))),r))}function transformSourceMapNames(o,e,n){const r={files:{},totalBytes:o.totalBytes};for(const t of Object.keys(o.files))r.files[e(trimClean(n,t))]=o.files[t];return r}function getGraphFiles(o){const e=new Set;for(const n of o)e.add(n.source),n.target&&e.add(n.target);return Array.from(e)}function trimClean(o,e){for(const n of o)if(e.startsWith(n))return e.slice(n.length);return e}function autoclean(o){const e=Object.keys(o.processedSourceMap.files),n=getGraphFiles(o.graphEdges),r=Object.keys(findTrims(e,n));return{sourceMapFiles:e.map(t=>trimClean(r,t)),graphFiles:n.map(t=>trimClean(r,t)),trims:r}}class Resolve extends react.exports.Component{constructor(e){super(e);this.sourceMapTransformRef=React.createRef(),this.sourceGraphTransformRef=React.createRef();const{sourceMapFiles:n,graphFiles:r,trims:t}=autoclean({processedSourceMap:this.props.processedBundle,graphEdges:this.props.graphEdges});this.trims=t,this.state={sourceMapFiles:n,graphFiles:r,transforms:{sourceMapFileTransform:e.sourceMapFileTransform&&toFunctionRef(e.sourceMapFileTransform)||(s=>s),graphFileTransform:e.graphFileTransform&&toFunctionRef(e.graphFileTransform)||(s=>s)}}}static sorted(e){const n=Array.from(e);return n.sort(),n}transformFiles(e,n,r,t){let s;const i=new Set(e.map(m=>{try{return r(m)}catch(d){return s=d,m}})),u=new Set(n.map(m=>{try{return t(m)}catch(d){return s=d,m}})),a=[];for(const m of i)u.has(m)||a.push(m);return{files:a,lastError:s}}updateSourceMapTransform(){if(this.sourceMapTransformRef!=null&&this.sourceMapTransformRef.current!=null){const e=toFunctionRef(this.sourceMapTransformRef.current.value);if(e==null)return;const n=storeResolveState({graphEdges:this.props.graphEdges,processedSourceMap:this.props.processedBundle,graphFileTransform:this.state.transforms.graphFileTransform.toString(),bundledFilesTransform:e.toString()});this.props.history.replace(window.location.pathname,n),this.setState({transforms:{graphFileTransform:this.state.transforms.graphFileTransform,sourceMapFileTransform:e}})}}updateGraphSourceTransform(){if(this.sourceGraphTransformRef!=null&&this.sourceGraphTransformRef.current!=null){const e=toFunctionRef(this.sourceGraphTransformRef.current.value);if(e==null)return;const n=storeResolveState({graphEdges:this.props.graphEdges,processedSourceMap:this.props.processedBundle,graphFileTransform:e.toString(),bundledFilesTransform:this.state.transforms.sourceMapFileTransform.toString()});this.props.history.replace(window.location.pathname,n),this.setState({transforms:{graphFileTransform:e,sourceMapFileTransform:this.state.transforms.sourceMapFileTransform}})}}import(){if(this.props.graphEdges==null||this.props.processedBundle==null)throw new Error("Unable to find graph edges or sourcemap data");const e=transform(transformGraphNames(this.props.graphEdges,this.state.transforms.graphFileTransform,this.trims),transformSourceMapNames(this.props.processedBundle,this.state.transforms.sourceMapFileTransform,this.trims),this.state.sourceMapFiles);this.props.history.push("/bundle",storeProcessedState(e))}formatError(e){return`
${e.message}

----------------

${e.stack}`}render(){const e=this.transformFiles(this.state.sourceMapFiles,this.state.graphFiles,this.state.transforms.sourceMapFileTransform,this.state.transforms.graphFileTransform),n=this.transformFiles(this.state.graphFiles,this.state.sourceMapFiles,this.state.transforms.graphFileTransform,this.state.transforms.sourceMapFileTransform);return React.createElement("div",{className:"resolve-conflicts"},React.createElement("div",{className:"col-container"},React.createElement("div",null,React.createElement("p",{className:"ft-18"},"Resolve source map files:"),e.lastError!=null?React.createElement("div",{className:"error"},this.formatError(e.lastError)):null,React.createElement("small",null,React.createElement("span",{className:`${e.files.length===0?"primary":""}`},e.files.length)," ","source map files of ",this.state.sourceMapFiles.length," total need resolving"),React.createElement("textarea",{ref:this.sourceMapTransformRef,className:"code-editor",defaultValue:this.state.transforms.sourceMapFileTransform.toString()}),React.createElement("br",null),React.createElement("button",{onClick:()=>this.updateSourceMapTransform()},"retry transform"),React.createElement("ul",null,Resolve.sorted(e.files).map(r=>React.createElement("li",{key:r},r)))),React.createElement("div",null,React.createElement("p",{className:"ft-18"},"Resolve graph source files:"),n.lastError!=null?React.createElement("div",{className:"error"},this.formatError(n.lastError)):null,React.createElement("small",null,React.createElement("span",{className:`${n.files.length===0?"primary":""}`},n.files.length)," ","graph files of ",this.state.graphFiles.length," total need resolving"),React.createElement("textarea",{ref:this.sourceGraphTransformRef,className:"code-editor",defaultValue:this.state.transforms.graphFileTransform.toString()}),React.createElement("br",null),React.createElement("button",{onClick:()=>this.updateGraphSourceTransform()},"Retry transform"),React.createElement("ul",null,Resolve.sorted(n.files).map(r=>React.createElement("li",{key:r},r))))),React.createElement("div",{className:"resolved"},React.createElement("div",{className:"resolved-message"},React.createElement("button",{className:"good",onClick:()=>this.import()},"Go to analysis"))))}}var Resolve$1=Resolve,ImportTypes;(function(o){o.ROLLUP="rollup",o.PARCEL="parcel",o.ROME="rome",o.WEBPACK="webpack",o.CRA="create-react-app",o.ESBUILD="esbuild"})(ImportTypes||(ImportTypes={}));async function toClipboard(o){await navigator.clipboard.writeText(o)}async function readFilesAsText(o){const e={};for(const n of o)e[n.name]=await readFileAsText(n);return e}function readFileAsText(o){return new Promise((e,n)=>{const r=new FileReader;r.onload=t=>{const s=t.target;e(s.result)},r.onabort=r.onerror=t=>Promise.reject(t),r.readAsText(o)})}function readFileAsBinary(o){return new Promise((e,n)=>{const r=new FileReader;r.onload=t=>{const s=t.target;e(s.result)},r.onabort=r.onerror=t=>Promise.reject(t),r.readAsBinaryString(o)})}var base64Vlq={},base64$1={};const intToCharMap="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");base64$1.encode=function(o){if(0<=o&&o<intToCharMap.length)return intToCharMap[o];throw new TypeError("Must be between 0 and 63: "+o)};const base64=base64$1,VLQ_BASE_SHIFT=5,VLQ_BASE=1<<VLQ_BASE_SHIFT,VLQ_BASE_MASK=VLQ_BASE-1,VLQ_CONTINUATION_BIT=VLQ_BASE;function toVLQSigned(o){return o<0?(-o<<1)+1:(o<<1)+0}base64Vlq.encode=function o(e){let n="",r,t=toVLQSigned(e);do r=t&VLQ_BASE_MASK,t>>>=VLQ_BASE_SHIFT,t>0&&(r|=VLQ_CONTINUATION_BIT),n+=base64.encode(r);while(t>0);return n};var util$3={};(function(o){function e(l,c,f){if(c in l)return l[c];if(arguments.length===3)return f;throw new Error('"'+c+'" is a required argument.')}o.getArg=e;const n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,r=/^data:.+\,.+$/;function t(l){const c=l.match(n);return c?{scheme:c[1],auth:c[2],host:c[3],port:c[4],path:c[5]}:null}o.urlParse=t;function s(l){let c="";return l.scheme&&(c+=l.scheme+":"),c+="//",l.auth&&(c+=l.auth+"@"),l.host&&(c+=l.host),l.port&&(c+=":"+l.port),l.path&&(c+=l.path),c}o.urlGenerate=s;const i=32;function u(l){const c=[];return function(f){for(let R=0;R<c.length;R++)if(c[R].input===f){const b=c[0];return c[0]=c[R],c[R]=b,c[0].result}const p=l(f);return c.unshift({input:f,result:p}),c.length>i&&c.pop(),p}}const a=u(function(c){let f=c;const p=t(c);if(p){if(!p.path)return c;f=p.path}const R=o.isAbsolute(f),b=[];let S=0,E=0;for(;;)if(S=E,E=f.indexOf("/",S),E===-1){b.push(f.slice(S));break}else for(b.push(f.slice(S,E));E<f.length&&f[E]==="/";)E++;let C=0;for(E=b.length-1;E>=0;E--){const M=b[E];M==="."?b.splice(E,1):M===".."?C++:C>0&&(M===""?(b.splice(E+1,C),C=0):(b.splice(E,2),C--))}return f=b.join("/"),f===""&&(f=R?"/":"."),p?(p.path=f,s(p)):f});o.normalize=a;function m(l,c){l===""&&(l="."),c===""&&(c=".");const f=t(c),p=t(l);if(p&&(l=p.path||"/"),f&&!f.scheme)return p&&(f.scheme=p.scheme),s(f);if(f||c.match(r))return c;if(p&&!p.host&&!p.path)return p.host=c,s(p);const R=c.charAt(0)==="/"?c:a(l.replace(/\/+$/,"")+"/"+c);return p?(p.path=R,s(p)):R}o.join=m,o.isAbsolute=function(l){return l.charAt(0)==="/"||n.test(l)};function d(l,c){l===""&&(l="."),l=l.replace(/\/$/,"");let f=0;for(;c.indexOf(l+"/")!==0;){const p=l.lastIndexOf("/");if(p<0||(l=l.slice(0,p),l.match(/^([^\/]+:\/)?\/*$/)))return c;++f}return Array(f+1).join("../")+c.substr(l.length+1)}o.relative=d;const h=function(){const l=Object.create(null);return!("__proto__"in l)}();function g(l){return l}function _(l){return v(l)?"$"+l:l}o.toSetString=h?g:_;function w(l){return v(l)?l.slice(1):l}o.fromSetString=h?g:w;function v(l){if(!l)return!1;const c=l.length;if(c<9||l.charCodeAt(c-1)!==95||l.charCodeAt(c-2)!==95||l.charCodeAt(c-3)!==111||l.charCodeAt(c-4)!==116||l.charCodeAt(c-5)!==111||l.charCodeAt(c-6)!==114||l.charCodeAt(c-7)!==112||l.charCodeAt(c-8)!==95||l.charCodeAt(c-9)!==95)return!1;for(let f=c-10;f>=0;f--)if(l.charCodeAt(f)!==36)return!1;return!0}function L(l,c,f){let p=y(l.source,c.source);return p!==0||(p=l.originalLine-c.originalLine,p!==0)||(p=l.originalColumn-c.originalColumn,p!==0||f)||(p=l.generatedColumn-c.generatedColumn,p!==0)||(p=l.generatedLine-c.generatedLine,p!==0)?p:y(l.name,c.name)}o.compareByOriginalPositions=L;function x(l,c,f){let p=l.generatedLine-c.generatedLine;return p!==0||(p=l.generatedColumn-c.generatedColumn,p!==0||f)||(p=y(l.source,c.source),p!==0)||(p=l.originalLine-c.originalLine,p!==0)||(p=l.originalColumn-c.originalColumn,p!==0)?p:y(l.name,c.name)}o.compareByGeneratedPositionsDeflated=x;function y(l,c){return l===c?0:l===null?1:c===null?-1:l>c?1:-1}function I(l,c){let f=l.generatedLine-c.generatedLine;return f!==0||(f=l.generatedColumn-c.generatedColumn,f!==0)||(f=y(l.source,c.source),f!==0)||(f=l.originalLine-c.originalLine,f!==0)||(f=l.originalColumn-c.originalColumn,f!==0)?f:y(l.name,c.name)}o.compareByGeneratedPositionsInflated=I;function N(l){return JSON.parse(l.replace(/^\)]}'[^\n]*\n/,""))}o.parseSourceMapInput=N;function F(l,c,f){if(c=c||"",l&&(l[l.length-1]!=="/"&&c[0]!=="/"&&(l+="/"),c=l+c),f){const p=t(f);if(!p)throw new Error("sourceMapURL could not be parsed");if(p.path){const R=p.path.lastIndexOf("/");R>=0&&(p.path=p.path.substring(0,R+1))}c=m(s(p),c)}return a(c)}o.computeSourceURL=F})(util$3);var arraySet={};class ArraySet$2{constructor(){this._array=[],this._set=new Map}static fromArray(e,n){const r=new ArraySet$2;for(let t=0,s=e.length;t<s;t++)r.add(e[t],n);return r}size(){return this._set.size}add(e,n){const r=this.has(e),t=this._array.length;(!r||n)&&this._array.push(e),r||this._set.set(e,t)}has(e){return this._set.has(e)}indexOf(e){const n=this._set.get(e);if(n>=0)return n;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}}arraySet.ArraySet=ArraySet$2;var mappingList={};const util$2=util$3;function generatedPositionAfter(o,e){const n=o.generatedLine,r=e.generatedLine,t=o.generatedColumn,s=e.generatedColumn;return r>n||r==n&&s>=t||util$2.compareByGeneratedPositionsInflated(o,e)<=0}class MappingList$1{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(e,n){this._array.forEach(e,n)}add(e){generatedPositionAfter(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))}toArray(){return this._sorted||(this._array.sort(util$2.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}}mappingList.MappingList=MappingList$1;const base64VLQ=base64Vlq,util$1=util$3,ArraySet$1=arraySet.ArraySet,MappingList=mappingList.MappingList;class SourceMapGenerator{constructor(e){e||(e={}),this._file=util$1.getArg(e,"file",null),this._sourceRoot=util$1.getArg(e,"sourceRoot",null),this._skipValidation=util$1.getArg(e,"skipValidation",!1),this._sources=new ArraySet$1,this._names=new ArraySet$1,this._mappings=new MappingList,this._sourcesContents=null}static fromSourceMap(e){const n=e.sourceRoot,r=new SourceMapGenerator({file:e.file,sourceRoot:n});return e.eachMapping(function(t){const s={generated:{line:t.generatedLine,column:t.generatedColumn}};t.source!=null&&(s.source=t.source,n!=null&&(s.source=util$1.relative(n,s.source)),s.original={line:t.originalLine,column:t.originalColumn},t.name!=null&&(s.name=t.name)),r.addMapping(s)}),e.sources.forEach(function(t){let s=t;n!==null&&(s=util$1.relative(n,t)),r._sources.has(s)||r._sources.add(s);const i=e.sourceContentFor(t);i!=null&&r.setSourceContent(t,i)}),r}addMapping(e){const n=util$1.getArg(e,"generated"),r=util$1.getArg(e,"original",null);let t=util$1.getArg(e,"source",null),s=util$1.getArg(e,"name",null);this._skipValidation||this._validateMapping(n,r,t,s),t!=null&&(t=String(t),this._sources.has(t)||this._sources.add(t)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:n.line,generatedColumn:n.column,originalLine:r!=null&&r.line,originalColumn:r!=null&&r.column,source:t,name:s})}setSourceContent(e,n){let r=e;this._sourceRoot!=null&&(r=util$1.relative(this._sourceRoot,r)),n!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[util$1.toSetString(r)]=n):this._sourcesContents&&(delete this._sourcesContents[util$1.toSetString(r)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(e,n,r){let t=n;if(n==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);t=e.file}const s=this._sourceRoot;s!=null&&(t=util$1.relative(s,t));const i=this._mappings.toArray().length>0?new ArraySet$1:this._sources,u=new ArraySet$1;this._mappings.unsortedForEach(function(a){if(a.source===t&&a.originalLine!=null){const h=e.originalPositionFor({line:a.originalLine,column:a.originalColumn});h.source!=null&&(a.source=h.source,r!=null&&(a.source=util$1.join(r,a.source)),s!=null&&(a.source=util$1.relative(s,a.source)),a.originalLine=h.line,a.originalColumn=h.column,h.name!=null&&(a.name=h.name))}const m=a.source;m!=null&&!i.has(m)&&i.add(m);const d=a.name;d!=null&&!u.has(d)&&u.add(d)},this),this._sources=i,this._names=u,e.sources.forEach(function(a){const m=e.sourceContentFor(a);m!=null&&(r!=null&&(a=util$1.join(r,a)),s!=null&&(a=util$1.relative(s,a)),this.setSourceContent(a,m))},this)}_validateMapping(e,n,r,t){if(n&&typeof n.line!="number"&&typeof n.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!n&&!r&&!t)){if(!(e&&"line"in e&&"column"in e&&n&&"line"in n&&"column"in n&&e.line>0&&e.column>=0&&n.line>0&&n.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:n,name:t}))}}_serializeMappings(){let e=0,n=1,r=0,t=0,s=0,i=0,u="",a,m,d,h;const g=this._mappings.toArray();for(let _=0,w=g.length;_<w;_++){if(m=g[_],a="",m.generatedLine!==n)for(e=0;m.generatedLine!==n;)a+=";",n++;else if(_>0){if(!util$1.compareByGeneratedPositionsInflated(m,g[_-1]))continue;a+=","}a+=base64VLQ.encode(m.generatedColumn-e),e=m.generatedColumn,m.source!=null&&(h=this._sources.indexOf(m.source),a+=base64VLQ.encode(h-i),i=h,a+=base64VLQ.encode(m.originalLine-1-t),t=m.originalLine-1,a+=base64VLQ.encode(m.originalColumn-r),r=m.originalColumn,m.name!=null&&(d=this._names.indexOf(m.name),a+=base64VLQ.encode(d-s),s=d)),u+=a}return u}_generateSourcesContent(e,n){return e.map(function(r){if(!this._sourcesContents)return null;n!=null&&(r=util$1.relative(n,r));const t=util$1.toSetString(r);return Object.prototype.hasOwnProperty.call(this._sourcesContents,t)?this._sourcesContents[t]:null},this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}}SourceMapGenerator.prototype._version=3;var sourceMapConsumer={},binarySearch$1={};(function(o){o.GREATEST_LOWER_BOUND=1,o.LEAST_UPPER_BOUND=2;function e(n,r,t,s,i,u){const a=Math.floor((r-n)/2)+n,m=i(t,s[a],!0);return m===0?a:m>0?r-a>1?e(a,r,t,s,i,u):u==o.LEAST_UPPER_BOUND?r<s.length?r:-1:a:a-n>1?e(n,a,t,s,i,u):u==o.LEAST_UPPER_BOUND?a:n<0?-1:n}o.search=function(r,t,s,i){if(t.length===0)return-1;let u=e(-1,t.length,r,t,s,i||o.GREATEST_LOWER_BOUND);if(u<0)return-1;for(;u-1>=0&&s(t[u],t[u-1],!0)===0;)--u;return u}})(binarySearch$1);var readWasm$2={exports:{}},__viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:__viteBrowserExternal}),require$$1=getAugmentedNamespace(__viteBrowserExternal$1);if(typeof fetch=="function"){let o=null;readWasm$2.exports=function(){if(typeof o!="string")throw new Error("You must provide the URL of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer");return fetch(o).then(n=>n.arrayBuffer())},readWasm$2.exports.initialize=e=>o=e}else{const o=require$$1,e=require$$1;readWasm$2.exports=function(){return new Promise((r,t)=>{const s=e.join(__dirname,"mappings.wasm");o.readFile(s,null,(i,u)=>{if(i){t(i);return}r(u.buffer)})})},readWasm$2.exports.initialize=n=>{console.debug("SourceMapConsumer.initialize is a no-op when running in node.js")}}const readWasm$1=readWasm$2.exports;function Mapping(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let cachedWasm=null;var wasm$1=function o(){if(cachedWasm)return cachedWasm;const e=[];return cachedWasm=readWasm$1().then(n=>WebAssembly.instantiate(n,{env:{mapping_callback(r,t,s,i,u,a,m,d,h,g){const _=new Mapping;_.generatedLine=r+1,_.generatedColumn=t,s&&(_.lastGeneratedColumn=i-1),u&&(_.source=a,_.originalLine=m+1,_.originalColumn=d,h&&(_.name=g)),e[e.length-1](_)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(n=>({exports:n.instance.exports,withMappingCallback:(r,t)=>{e.push(r);try{t()}finally{e.pop()}}})).then(null,n=>{throw cachedWasm=null,n}),cachedWasm};const util=util$3,binarySearch=binarySearch$1,ArraySet=arraySet.ArraySet,readWasm=readWasm$2.exports,wasm=wasm$1,INTERNAL=Symbol("smcInternal");class SourceMapConsumer$1{constructor(e,n){return e==INTERNAL?Promise.resolve(this):_factory(e,n)}static initialize(e){readWasm.initialize(e["lib/mappings.wasm"])}static fromSourceMap(e,n){return _factoryBSM(e,n)}static with(e,n,r){let t=null;return new SourceMapConsumer$1(e,n).then(i=>(t=i,r(i))).then(i=>(t&&t.destroy(),i),i=>{throw t&&t.destroy(),i})}_parseMappings(e,n){throw new Error("Subclasses must implement _parseMappings")}eachMapping(e,n,r){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(e){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}SourceMapConsumer$1.prototype._version=3;SourceMapConsumer$1.GENERATED_ORDER=1;SourceMapConsumer$1.ORIGINAL_ORDER=2;SourceMapConsumer$1.GREATEST_LOWER_BOUND=1;SourceMapConsumer$1.LEAST_UPPER_BOUND=2;sourceMapConsumer.SourceMapConsumer=SourceMapConsumer$1;class BasicSourceMapConsumer extends SourceMapConsumer$1{constructor(e,n){return super(INTERNAL).then(r=>{let t=e;typeof e=="string"&&(t=util.parseSourceMapInput(e));const s=util.getArg(t,"version");let i=util.getArg(t,"sources");const u=util.getArg(t,"names",[]);let a=util.getArg(t,"sourceRoot",null);const m=util.getArg(t,"sourcesContent",null),d=util.getArg(t,"mappings"),h=util.getArg(t,"file",null);if(s!=r._version)throw new Error("Unsupported version: "+s);return a&&(a=util.normalize(a)),i=i.map(String).map(util.normalize).map(function(g){return a&&util.isAbsolute(a)&&util.isAbsolute(g)?util.relative(a,g):g}),r._names=ArraySet.fromArray(u.map(String),!0),r._sources=ArraySet.fromArray(i,!0),r._absoluteSources=r._sources.toArray().map(function(g){return util.computeSourceURL(a,g,n)}),r.sourceRoot=a,r.sourcesContent=m,r._mappings=d,r._sourceMapURL=n,r.file=h,r._computedColumnSpans=!1,r._mappingsPtr=0,r._wasm=null,wasm().then(g=>(r._wasm=g,r))})}_findSourceIndex(e){let n=e;if(this.sourceRoot!=null&&(n=util.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(let r=0;r<this._absoluteSources.length;++r)if(this._absoluteSources[r]==e)return r;return-1}static fromSourceMap(e,n){return new BasicSourceMapConsumer(e.toString())}get sources(){return this._absoluteSources.slice()}_getMappingsPtr(){return this._mappingsPtr===0&&this._parseMappings(this._mappings,this.sourceRoot),this._mappingsPtr}_parseMappings(e,n){const r=e.length,t=this._wasm.exports.allocate_mappings(r),s=new Uint8Array(this._wasm.exports.memory.buffer,t,r);for(let u=0;u<r;u++)s[u]=e.charCodeAt(u);const i=this._wasm.exports.parse_mappings(t);if(!i){const u=this._wasm.exports.get_last_error();let a=`Error parsing mappings (code ${u}): `;switch(u){case 1:a+="the mappings contained a negative line, column, source index, or name index";break;case 2:a+="the mappings contained a number larger than 2**32";break;case 3:a+="reached EOF while in the middle of parsing a VLQ";break;case 4:a+="invalid base 64 character while parsing a VLQ";break;default:a+="unknown error code";break}throw new Error(a)}this._mappingsPtr=i}eachMapping(e,n,r){const t=n||null,s=r||SourceMapConsumer$1.GENERATED_ORDER,i=this.sourceRoot;this._wasm.withMappingCallback(u=>{u.source!==null&&(u.source=this._sources.at(u.source),u.source=util.computeSourceURL(i,u.source,this._sourceMapURL),u.name!==null&&(u.name=this._names.at(u.name))),e.call(t,u)},()=>{switch(s){case SourceMapConsumer$1.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case SourceMapConsumer$1.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(e){let n=util.getArg(e,"source");const r=util.getArg(e,"line"),t=e.column||0;if(n=this._findSourceIndex(n),n<0)return[];if(r<1)throw new Error("Line numbers must be >= 1");if(t<0)throw new Error("Column numbers must be >= 0");const s=[];return this._wasm.withMappingCallback(i=>{let u=i.lastGeneratedColumn;this._computedColumnSpans&&u===null&&(u=1/0),s.push({line:i.generatedLine,column:i.generatedColumn,lastColumn:u})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),n,r-1,"column"in e,t)}),s}destroy(){this._mappingsPtr!==0&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(e){const n={generatedLine:util.getArg(e,"line"),generatedColumn:util.getArg(e,"column")};if(n.generatedLine<1)throw new Error("Line numbers must be >= 1");if(n.generatedColumn<0)throw new Error("Column numbers must be >= 0");let r=util.getArg(e,"bias",SourceMapConsumer$1.GREATEST_LOWER_BOUND);r==null&&(r=SourceMapConsumer$1.GREATEST_LOWER_BOUND);let t;if(this._wasm.withMappingCallback(s=>t=s,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),n.generatedLine-1,n.generatedColumn,r)}),t&&t.generatedLine===n.generatedLine){let s=util.getArg(t,"source",null);s!==null&&(s=this._sources.at(s),s=util.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));let i=util.getArg(t,"name",null);return i!==null&&(i=this._names.at(i)),{source:s,line:util.getArg(t,"originalLine",null),column:util.getArg(t,"originalColumn",null),name:i}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1}sourceContentFor(e,n){if(!this.sourcesContent)return null;const r=this._findSourceIndex(e);if(r>=0)return this.sourcesContent[r];let t=e;this.sourceRoot!=null&&(t=util.relative(this.sourceRoot,t));let s;if(this.sourceRoot!=null&&(s=util.urlParse(this.sourceRoot))){const i=t.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(i))return this.sourcesContent[this._sources.indexOf(i)];if((!s.path||s.path=="/")&&this._sources.has("/"+t))return this.sourcesContent[this._sources.indexOf("/"+t)]}if(n)return null;throw new Error('"'+t+'" is not in the SourceMap.')}generatedPositionFor(e){let n=util.getArg(e,"source");if(n=this._findSourceIndex(n),n<0)return{line:null,column:null,lastColumn:null};const r={source:n,originalLine:util.getArg(e,"line"),originalColumn:util.getArg(e,"column")};if(r.originalLine<1)throw new Error("Line numbers must be >= 1");if(r.originalColumn<0)throw new Error("Column numbers must be >= 0");let t=util.getArg(e,"bias",SourceMapConsumer$1.GREATEST_LOWER_BOUND);t==null&&(t=SourceMapConsumer$1.GREATEST_LOWER_BOUND);let s;if(this._wasm.withMappingCallback(i=>s=i,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),r.source,r.originalLine-1,r.originalColumn,t)}),s&&s.source===r.source){let i=s.lastGeneratedColumn;return this._computedColumnSpans&&i===null&&(i=1/0),{line:util.getArg(s,"generatedLine",null),column:util.getArg(s,"generatedColumn",null),lastColumn:i}}return{line:null,column:null,lastColumn:null}}}BasicSourceMapConsumer.prototype.consumer=SourceMapConsumer$1;sourceMapConsumer.BasicSourceMapConsumer=BasicSourceMapConsumer;class IndexedSourceMapConsumer extends SourceMapConsumer$1{constructor(e,n){return super(INTERNAL).then(r=>{let t=e;typeof e=="string"&&(t=util.parseSourceMapInput(e));const s=util.getArg(t,"version"),i=util.getArg(t,"sections");if(s!=r._version)throw new Error("Unsupported version: "+s);r._sources=new ArraySet,r._names=new ArraySet,r.__generatedMappings=null,r.__originalMappings=null,r.__generatedMappingsUnsorted=null,r.__originalMappingsUnsorted=null;let u={line:-1,column:0};return Promise.all(i.map(a=>{if(a.url)throw new Error("Support for url field in sections not implemented.");const m=util.getArg(a,"offset"),d=util.getArg(m,"line"),h=util.getArg(m,"column");if(d<u.line||d===u.line&&h<u.column)throw new Error("Section offsets must be ordered and non-overlapping.");return u=m,new SourceMapConsumer$1(util.getArg(a,"map"),n).then(_=>({generatedOffset:{generatedLine:d+1,generatedColumn:h+1},consumer:_}))})).then(a=>(r._sections=a,r))})}get _generatedMappings(){return this.__generatedMappings||this._sortGeneratedMappings(),this.__generatedMappings}get _originalMappings(){return this.__originalMappings||this._sortOriginalMappings(),this.__originalMappings}get _generatedMappingsUnsorted(){return this.__generatedMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappingsUnsorted}get _originalMappingsUnsorted(){return this.__originalMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappingsUnsorted}_sortGeneratedMappings(){const e=this._generatedMappingsUnsorted;e.sort(util.compareByGeneratedPositionsDeflated),this.__generatedMappings=e}_sortOriginalMappings(){const e=this._originalMappingsUnsorted;e.sort(util.compareByOriginalPositions),this.__originalMappings=e}get sources(){const e=[];for(let n=0;n<this._sections.length;n++)for(let r=0;r<this._sections[n].consumer.sources.length;r++)e.push(this._sections[n].consumer.sources[r]);return e}originalPositionFor(e){const n={generatedLine:util.getArg(e,"line"),generatedColumn:util.getArg(e,"column")},r=binarySearch.search(n,this._sections,function(s,i){const u=s.generatedLine-i.generatedOffset.generatedLine;return u||s.generatedColumn-i.generatedOffset.generatedColumn}),t=this._sections[r];return t?t.consumer.originalPositionFor({line:n.generatedLine-(t.generatedOffset.generatedLine-1),column:n.generatedColumn-(t.generatedOffset.generatedLine===n.generatedLine?t.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})}sourceContentFor(e,n){for(let r=0;r<this._sections.length;r++){const s=this._sections[r].consumer.sourceContentFor(e,!0);if(s)return s}if(n)return null;throw new Error('"'+e+'" is not in the SourceMap.')}generatedPositionFor(e){for(let n=0;n<this._sections.length;n++){const r=this._sections[n];if(r.consumer._findSourceIndex(util.getArg(e,"source"))===-1)continue;const t=r.consumer.generatedPositionFor(e);if(t)return{line:t.line+(r.generatedOffset.generatedLine-1),column:t.column+(r.generatedOffset.generatedLine===t.line?r.generatedOffset.generatedColumn-1:0)}}return{line:null,column:null}}_parseMappings(e,n){const r=this.__generatedMappingsUnsorted=[],t=this.__originalMappingsUnsorted=[];for(let s=0;s<this._sections.length;s++){const i=this._sections[s],u=[];i.consumer.eachMapping(a=>u.push(a));for(let a=0;a<u.length;a++){const m=u[a];let d=util.computeSourceURL(i.consumer.sourceRoot,null,this._sourceMapURL);this._sources.add(d),d=this._sources.indexOf(d);let h=null;m.name&&(this._names.add(m.name),h=this._names.indexOf(m.name));const g={source:d,generatedLine:m.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:m.generatedColumn+(i.generatedOffset.generatedLine===m.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:m.originalLine,originalColumn:m.originalColumn,name:h};r.push(g),typeof g.originalLine=="number"&&t.push(g)}}}eachMapping(e,n,r){const t=n||null,s=r||SourceMapConsumer$1.GENERATED_ORDER;let i;switch(s){case SourceMapConsumer$1.GENERATED_ORDER:i=this._generatedMappings;break;case SourceMapConsumer$1.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}const u=this.sourceRoot;i.map(function(a){let m=null;return a.source!==null&&(m=this._sources.at(a.source),m=util.computeSourceURL(u,m,this._sourceMapURL)),{source:m,generatedLine:a.generatedLine,generatedColumn:a.generatedColumn,originalLine:a.originalLine,originalColumn:a.originalColumn,name:a.name===null?null:this._names.at(a.name)}},this).forEach(e,t)}_findMapping(e,n,r,t,s,i){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[t]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[t]);return binarySearch.search(e,n,s,i)}allGeneratedPositionsFor(e){const n=util.getArg(e,"line"),r={source:util.getArg(e,"source"),originalLine:n,originalColumn:util.getArg(e,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];if(r.originalLine<1)throw new Error("Line numbers must be >= 1");if(r.originalColumn<0)throw new Error("Column numbers must be >= 0");const t=[];let s=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",util.compareByOriginalPositions,binarySearch.LEAST_UPPER_BOUND);if(s>=0){let i=this._originalMappings[s];if(e.column===void 0){const u=i.originalLine;for(;i&&i.originalLine===u;){let a=i.lastGeneratedColumn;this._computedColumnSpans&&a===null&&(a=1/0),t.push({line:util.getArg(i,"generatedLine",null),column:util.getArg(i,"generatedColumn",null),lastColumn:a}),i=this._originalMappings[++s]}}else{const u=i.originalColumn;for(;i&&i.originalLine===n&&i.originalColumn==u;){let a=i.lastGeneratedColumn;this._computedColumnSpans&&a===null&&(a=1/0),t.push({line:util.getArg(i,"generatedLine",null),column:util.getArg(i,"generatedColumn",null),lastColumn:a}),i=this._originalMappings[++s]}}}return t}destroy(){for(let e=0;e<this._sections.length;e++)this._sections[e].consumer.destroy()}}sourceMapConsumer.IndexedSourceMapConsumer=IndexedSourceMapConsumer;function _factory(o,e){let n=o;typeof o=="string"&&(n=util.parseSourceMapInput(o));const r=n.sections!=null?new IndexedSourceMapConsumer(n,e):new BasicSourceMapConsumer(n,e);return Promise.resolve(r)}function _factoryBSM(o,e){return BasicSourceMapConsumer.fromSourceMap(o,e)}var SourceMapConsumer=sourceMapConsumer.SourceMapConsumer;SourceMapConsumer.initialize({"lib/mappings.wasm":"/mappings.wasm"});function getTotalSize(o){return Object.values(o).reduce((e,n)=>({totalBytes:e.totalBytes+n.totalBytes}),{totalBytes:0}).totalBytes}function calculateSourcemapFileContents(o){function e(n,r,t){t.source!=null&&(r.files[t.source]==null&&(r.files[t.source]={totalBytes:0}),t.generatedLine!=null&&(n.line!==t.generatedLine&&t.generatedLine!=null&&(n.line=t.generatedLine),n.column=t.lastGeneratedColumn||1,t.lastGeneratedColumn!=null&&t.lastGeneratedColumn!==-1?r.files[t.source].totalBytes+=t.lastGeneratedColumn-t.generatedColumn+1:r.files[t.source].totalBytes+=1))}return new Promise((n,r)=>{SourceMapConsumer.with(o,null,t=>{const s={totalBytes:0,files:{}},i={line:1,column:1};try{t.computeColumnSpans()}catch(u){r(u);return}t.eachMapping(u=>e(i,s,u)),s.totalBytes=getTotalSize(s.files),n(s)}).catch(t=>r(t))})}function mergeProcessedBundles(o){const e={files:{},totalBytes:Object.values(o).reduce((n,r)=>({totalBytes:n.totalBytes+r.totalBytes}),{totalBytes:0}).totalBytes};for(const n of Object.keys(o))for(const r of Object.keys(o[n].files))(e.files[r]==null||e.files[r].totalBytes<o[n].files[r].totalBytes)&&(e.files[r]=o[n].files[r]);return e}function humanizeSourceMapImportError(o){return`importing source map: 
${o.toString()}`}function humanizeGraphProcessError(o){return`importing graph contents: 
${o.toString()}`}async function processImports(o){const e={bundleSizes:{},processedSourcemap:{files:{},totalBytes:0}},n={};for(const r of Object.keys(o.sourceMapContents))if(e.sourceMapProcessError==null)try{n[r]=await calculateSourcemapFileContents(o.sourceMapContents[r])}catch(t){e.sourceMapProcessError=new Error(humanizeSourceMapImportError(t))}for(const r of Object.keys(n))e.bundleSizes[r]={totalBytes:n[r].totalBytes};e.processedSourcemap=mergeProcessedBundles(n);try{if(typeof o.graphEdges=="string"){let r=JSON.parse(o.graphEdges);o.graphPreProcessFn!=null&&(r=o.graphPreProcessFn(r)),e.processedGraph=r}else e.processedGraph=o.graphEdges}catch(r){e.graphProcessError=new Error(humanizeGraphProcessError(r))}return e}function buildImportErrorReport(o,e){let n=null;const r=new ReportErrorUri;return o.graphProcessError!=null&&(n=`${e.graphFile.name} ${o.graphProcessError}
`,r.addError(e.graphFile.name,o.graphProcessError)),o.sourceMapProcessError!=null&&(n==null&&(n=""),r.addError(Object.keys(e.sourceMapFiles.map(t=>t.name)).join(","),o.sourceMapProcessError),n+=`${Object.keys(e.sourceMapFiles.map(t=>t.name)).join(",")}: ${o.sourceMapProcessError}`),{importError:n,importErrorUri:r.toUri()}}function toEdges(o){const e=[];for(const[n,r]of Object.entries(o.inputs))for(const{path:t}of r.imports)e.push({source:n,target:t});return e}function toProcessedBundles(o){const e={};for(const[n,r]of Object.entries(o.outputs)){const t={};for(const[s,i]of Object.entries(r.inputs))t[s]={totalBytes:i.bytesInOutput};e[n]={totalBytes:r.bytes,files:t}}return e}var builtins=["assert","async_hooks","buffer","child_process","cluster","console","constants","crypto","dgram","dns","domain","events","fs","http","http2","https","inspector","module","net","os","path","perf_hooks","process","punycode","querystring","readline","repl","stream","string_decoder","timers","tls","tty","url","util","v8","vm","zlib"];function findCommonPrefix(o){let e=null;for(const n of o)if(e==null)e=n;else{let r=!1;for(let t=n.length;t>0;t--){const s=n.slice(0,t);if(e.indexOf(s)!==-1){e=s,r=!0;break}if(s.length===1)break}if(!r){e="";break}}if(e){const n=e.indexOf("node_modules");if(n!==-1)return e.slice(0,n)}return e}function findFirstIndex(o){let e={},n=0;for(const t of o){if(t==null)continue;const s=t.indexOf("/");e[s]||(e[s]=0),e[s]++,n++}let r=0;return Array.from(Object.keys(e)).find(t=>e[parseInt(t)]/n>=.8?(r=parseInt(t),!0):!1),r}const prefixStrips=["\0commonjs-proxy:","commonjs-proxy:/","\0commonjs-external:","\0"],ignoreNodes=new Set(["\0commonjsHelpers","commonjsHelpers","babelHelpers"].concat(builtins));function removedIgnoredFiles(o){return o.filter(e=>!ignoreNodes.has(e))}function getAllGraphFiles(o){const e=new Set;for(const{target:n,source:r}of o)n!=null&&e.add(n),e.add(r);return Array.from(e)}function cleanGraph(o){for(const t of o)for(const s of Object.keys(t))if(t[s]!=null)for(const i of prefixStrips)t[s].startsWith(i)&&t[s].length!==i.length&&(t[s]=t[s].slice(i.length));const e=removedIgnoredFiles(getAllGraphFiles(o)),n=findCommonPrefix(removedIgnoredFiles(e))||"";if(n.length)for(const t of o)for(const s of Object.keys(t))t[s]!=null&&t[s].startsWith(n)&&(t[s]=t[s].slice(n.length));else{const t=findFirstIndex(removedIgnoredFiles(e));if(t>0)for(const s of o)for(const i of Object.keys(s))s[i]!=null&&s[i][t]==="/"&&(s[i]=s[i].slice(t+1))}const r=[];for(const t of o)t.target!==t.source&&t.target!==null&&t.source!==null&&r.push(t);return r}function cleanWebpackMagicFiles(o){const e=[{replace:"node_modules/webpack/buildin",matcher:/\(webpack\)\/buildin/}];for(const n of e)if(n.matcher.exec(o))return o.replace(n.matcher.exec(o)[0],n.replace);return o}function cleanEdges(o,e){const n=[];let r=!1;for(const t of o){const s=e.get(t.target);if(s){r=!0;for(const i of s.values())n.push({target:i,source:t.source})}else n.push(t)}return r?cleanEdges(n,e):n}function gatherEdges(o,e=[],n=new Set,r=new Map){for(const t of o.modules||[])if(t.modules!=null){if(!r.has(t.name)){r.set(t.name,new Set);for(const s of t.modules)r.get(t.name).add(s.name)}e=gatherEdges({modules:t.modules},e,n,r).edges}else{const s=cleanWebpackMagicFiles(t.name);for(const i of t.reasons||[]){const u=cleanWebpackMagicFiles(i.moduleName);n.has(`${s}|${u}`)||(e.push({source:u,target:s}),n.add(`${s}|${u}`))}}return{edges:e,plusMap:r}}function statsToGraph(o){const{edges:e,plusMap:n}=gatherEdges(o);return cleanEdges(e,n)}const IGNORE_FILES=["webpack/bootstrap"];function removeWebpackMagicFiles(o){const e={totalBytes:o.totalBytes,files:{}};for(const n of Object.keys(o.files)){let r=!1;for(const t of IGNORE_FILES)n.endsWith(t)&&(r=!0);r||(e.files[n]=o.files[n])}return e}class Import extends react.exports.Component{constructor(e){super(e);this.state={},this.sourceMapInput=React.createRef(),this.graphInput=React.createRef(),this.generateGraphContents=React.createRef()}onGraphInput(){this.graphInput!=null&&this.graphInput.current!=null&&this.graphInput.current.files.length?this.setState({graphFile:this.graphInput.current.files[0]},()=>{this.canProcess(this.state.sourceMapFiles,this.state.graphFile,this.props.importType)&&this.processFiles(this.props.importType)}):this.setState({graphFile:void 0})}onSourceMapInput(){this.sourceMapInput!=null&&this.sourceMapInput.current!=null&&this.sourceMapInput.current.files.length?this.setState({sourceMapFiles:Array.from(this.sourceMapInput.current.files)},()=>{this.canProcess(this.state.sourceMapFiles,this.state.graphFile,this.props.importType)&&this.processFiles(this.props.importType)}):this.setState({sourceMapFiles:void 0})}hasGraphFile(e){return e!=null||window.location.pathname.includes("resolve")}hasSourceMapFile(e){return e!=null&&e.length||window.location.pathname.includes("resolve")}canProcess(e,n,r){return(r===ImportTypes.ESBUILD||e!=null&&e.length)&&n!=null}async processFiles(e){if(console.log("IN PROCESS"),e===ImportTypes.ESBUILD&&this.state.graphFile!=null){const u=JSON.parse(await readFileAsText(this.state.graphFile)),a={graphEdges:toEdges(u),processedSourceMap:mergeProcessedBundles(toProcessedBundles(u))};this.props.history.push(`/${this.props.importType}/resolve`,storeResolveState(a));return}if(this.state.graphFile==null||this.state.sourceMapFiles==null)return;const n=await readFileAsText(this.state.graphFile),r=await readFilesAsText(this.state.sourceMapFiles);let t;e===ImportTypes.WEBPACK||e===ImportTypes.CRA?(t=await processImports({sourceMapContents:r,graphEdges:n,graphPreProcessFn:u=>cleanGraph(statsToGraph(u))}),t.processedSourcemap!=null&&(t.processedSourcemap=removeWebpackMagicFiles(t.processedSourcemap))):t=await processImports({sourceMapContents:r,graphEdges:n});const{importError:s,importErrorUri:i}=buildImportErrorReport(t,{graphFile:this.state.graphFile,sourceMapFiles:this.state.sourceMapFiles});if(this.setState({importError:s,importErrorUri:i}),this.props.history!=null&&this.state.importError==null){const u={graphEdges:t.processedGraph,processedSourceMap:t.processedSourcemap};this.props.history.push(`/${this.props.importType}/resolve`,storeResolveState(u))}}disableSourceMapInput(e){return e===ImportTypes.ESBUILD}render(){const e=this.props.importType;let n,r,t;return e===ImportTypes.WEBPACK?(r=React.createElement("div",{className:"right-spacing"},React.createElement("p",null,"webpack.conf.js"),React.createElement("code",null,React.createElement("pre",null,React.createElement("span",{className:"add-diff"},'devtool: "source-map"')),React.createElement("button",{onClick:()=>toClipboard("devtool: 'source-map'"),className:"copy-button","aria-label":"Copy sourcemap snippet to clipboard"}))),n=React.createElement("div",{className:"right-spacing"},React.createElement("p",null,"via command line"),React.createElement("code",null,React.createElement("pre",null,React.createElement("span",{className:"add-diff"},"webpack --profile --json ",">"," stats.json")),React.createElement("button",{onClick:()=>toClipboard("webpack --profile --json > stats.json"),className:"copy-button","aria-label":"Copy stats.json CLI command to clipboard"})),React.createElement("p",null,"via programatic compilation "),React.createElement("code",null,React.createElement("pre",null,`const webpack = require("webpack");
webpack({
// Configuration Object
}, (err, stats) => {
if (err) {
console.error(err);
return;
}`,React.createElement("span",{className:"add-diff"},`
fs.writeFileSync(
path.join(__dirname, "stats.json"), 
JSON.stringify(stats.toJson()), 
'utf-8');
});
`)),React.createElement("button",{onClick:()=>toClipboard(`fs.writeFileSync(path.join(__dirname, "stats.json"), JSON.stringify(stats.toJson()), 'utf-8')`),className:"copy-button","aria-label":"Copy stats.json programatic snippit to clipboard"})))):e===ImportTypes.CRA?t=React.createElement("div",{className:"col-container"},React.createElement("div",{className:"right-spacing"},React.createElement("p",null,"Using yarn, in your project directory run: "),React.createElement("code",null,React.createElement("pre",null,React.createElement("span",{className:"add-diff"},"GENERATE_SOURCEMAP=true yarn run build -- --stats"),React.createElement("br",null)),React.createElement("button",{onClick:()=>toClipboard("devtool: 'source-map'"),className:"copy-button","aria-label":"Copy sourcemap snippet to clipboard"}))),React.createElement("div",null," ",React.createElement("p",null,"Or, using npm, in your project directory run: "),React.createElement("code",null,React.createElement("pre",null,React.createElement("span",{className:"add-diff"},"GENERATE_SOURCEMAP=true npm run build -- --stats")),React.createElement("button",{onClick:()=>toClipboard("devtool: 'source-map'"),className:"copy-button","aria-label":"Copy sourcemap snippet to clipboard"})))):e===ImportTypes.ROLLUP?(n=React.createElement("div",null,React.createElement("p",null,"rollup.config.js"),React.createElement("code",null,React.createElement("pre",null,React.createElement("span",{id:"rollup-generate-graph",ref:this.generateGraphContents,className:"add-diff"},`
plugins: [{
buildEnd() {
  const deps = [];
  for (const id of this.getModuleIds()) {
    const m = this.getModuleInfo(id);
    if (m != null && !m.isExternal) {
      for (const target of m.importedIds) {
        deps.push({ source: m.id, target })
      }
    }
  }
  
  fs.writeFileSync(
      path.join(__dirname, 'graph.json'), 
      JSON.stringify(deps, null, 2));
},
}]`)),React.createElement("button",{onClick:()=>toClipboard(this.generateGraphContents.current.textContent||""),className:"copy-button","aria-label":"Copy stats.json programatic snippit to clipboard"}))),r=React.createElement("div",null,React.createElement("p",null,"rollup.config.js"),React.createElement("code",null,React.createElement("pre",null,`output: { 
    file: '\`\${outFolder}/dist.js',
    format: 'iife',
    name: 'PROJECT_NAME',
`,React.createElement("span",{className:"add-diff"},"\xA0\xA0\xA0\xA0sourcemap: true,"),`
}`),React.createElement("button",{onClick:()=>toClipboard("sourcemap: true,"),className:"copy-button","aria-label":"Copy sourcemap snippet to clipboard"})))):e===ImportTypes.ROME?t=React.createElement("div",null,React.createElement("p",null,"Run the ",React.createElement("code",null,"bundle")," command of rome to generate the sourcemap files and bundlebuddy.json for your project"),React.createElement("code",null,React.createElement("pre",null,"rome bundle .")),React.createElement("button",{onClick:()=>toClipboard("devtool: 'source-map'"),className:"copy-button","aria-label":"Copy sourcemap snippet to clipboard"})):e===ImportTypes.PARCEL?t=React.createElement("div",null,React.createElement("p",null,"run ",React.createElement("code",null,"BUNDLE_BUDDY=true parcel build"),"\xA0 to generate the sourcemap files and bundle-buddy.json file for your project"),React.createElement("code",null,React.createElement("pre",null,"BUNDLE_BUDDY=true parcel build")),React.createElement("button",{onClick:()=>toClipboard("BUNDLE_BUDDY=true parcel build"),className:"copy-button","aria-label":"Copy sourcemap snippet to clipboard"})):e===ImportTypes.ESBUILD&&(t=React.createElement("div",null,React.createElement("p",null,"Run the ",React.createElement("code",null,"--bundle")," command of ",React.createElement("code",null,"esbuild")," with"," ",React.createElement("code",null,"--metafile=esbuild")," to generate the metadata file to understand your project."),React.createElement("code",null,React.createElement("pre",null,"esbuild --bundle --metafile")),React.createElement("button",{onClick:()=>toClipboard("esbuild --bundle --metafile"),className:"copy-button","aria-label":"Copy sourcemap snippet to clipboard"}))),React.createElement("div",null,React.createElement("div",null,this.state.importError!=null?React.createElement("div",{className:"error"},React.createElement("h2",null,"Import error"),React.createElement("code",null,React.createElement("pre",null,`${this.state.importError}`)),React.createElement("a",{href:this.state.importErrorUri||"",target:"_blank",rel:"noopener noreferrer"},"File a bug")):null,React.createElement("h3",null,"Upload assets:"),React.createElement("div",{className:"upload-files-container flex"},React.createElement("div",{className:"right-spacing"},React.createElement("div",{className:"button-import-container"},React.createElement("button",{tabIndex:-1,className:"import-asset"},React.createElement("img",{height:"20px",width:"20px",className:"attach-icon",alt:"attach file",src:"/img/attach_icon.svg"}),this.props.graphFileName,React.createElement("input",{id:"stats",type:"file",accept:".json",ref:this.graphInput,onInput:()=>this.onGraphInput()})),React.createElement("img",{src:this.hasGraphFile(this.state.graphFile)?"/img/ok_icon.svg":"/img/warn_icon.svg",height:"24px",width:"24px",alt:this.hasGraphFile(this.state.graphFile)?"OK import":"missing import",className:"status-icon"})),n),this.disableSourceMapInput(this.props.importType)?null:React.createElement("div",{className:"right-spacing"},React.createElement("div",{className:"button-import-container"},React.createElement("button",{tabIndex:-1,className:"import-asset"},React.createElement("img",{height:"20px",width:"20px",className:"attach-icon",alt:"attach file",src:"/img/attach_icon.svg"}),"sourcemaps",React.createElement("input",{id:"sourcemap",multiple:!0,type:"file",accept:".map,.sourcemap",ref:this.sourceMapInput,onInput:()=>this.onSourceMapInput()})),React.createElement("img",{src:this.hasSourceMapFile(this.state.sourceMapFiles)?"/img/ok_icon.svg":"/img/warn_icon.svg",height:"24px",width:"24px",alt:this.hasSourceMapFile(this.state.sourceMapFiles)?"OK import":"missing import",className:"status-icon"})),r)),React.createElement("div",{className:"import-instruction"},t)))}}var Importer=Import;class ImportSelector extends react.exports.Component{constructor(e){super(e);this.existingImportInput=React.createRef()}async onExistingImportInput(){var s;const e=(s=this.existingImportInput.current)==null?void 0:s.files[0];if(e==null)return;const n=await readFileAsBinary(e),r=pako_1.inflate(n),t=JSON.parse(new TextDecoder().decode(r));this.props.history.push("/bundle",storeProcessedState(t))}render(){return React.createElement("div",null,React.createElement("div",{className:"flex"},React.createElement("div",{style:{flexGrow:1,display:"flex",flexWrap:"wrap"}},React.createElement(Link,{to:"/webpack","aria-label":"webpack project import",className:"no-link-underline "},React.createElement("button",{"aria-hidden":!0,tabIndex:-1,className:"type-button project-import"},React.createElement("img",{width:"35px",height:"36px",className:"rollup-logo",alt:"webpack logo",src:"/img/webpack_logo.png"}),React.createElement("span",null,"Webpack"))),React.createElement(Link,{to:"/create-react-app","aria-label":"create-react-app project import",className:"no-link-underline "},React.createElement("button",{"aria-hidden":!0,tabIndex:-1,className:"type-button project-import"},React.createElement("img",{width:"35px",height:"36px",className:"rollup-logo",alt:"create react app logo",src:"/img/webpack_logo.png"}),React.createElement("span",null,"Create React App"))),React.createElement(Link,{to:"/rollup","aria-label":"rollup project import",className:"no-link-underline "},React.createElement("button",{"aria-hidden":!0,tabIndex:-1,className:"type-button project-import"},React.createElement("img",{width:"34px",height:"36px",alt:"rollup logo",src:"/img/rollup_logo.png",className:"rollup-logo"})," ",React.createElement("span",null,"Rollup"))),React.createElement(Link,{to:"/rome","aria-label":"rome project import",className:"no-link-underline "},React.createElement("button",{"aria-hidden":!0,tabIndex:-1,className:"type-button project-import rome-import"},React.createElement("img",{width:"31px",height:"36px",alt:"rome logo",src:"/img/rome_logo.png",className:"rome-logo"})," ",React.createElement("span",null,"Rome"))),React.createElement(Link,{to:"/parcel","aria-label":"parcel project import",className:"no-link-underline "},React.createElement("button",{"aria-hidden":!0,tabIndex:-1,className:"type-button project-import parcel-import"},React.createElement("img",{width:"35px",height:"26px",alt:"parcel logo",src:"/img/parcel_logo.png",className:"parcel-logo"})," ",React.createElement("span",null,"Parcel"))),React.createElement(Link,{to:"/esbuild","aria-label":"esbuild project import",className:"no-link-underline "},React.createElement("button",{"aria-hidden":!0,tabIndex:-1,className:"type-button project-import esbuild-import"},React.createElement("span",null,"ESBuild")))),React.createElement("button",{tabIndex:-1},React.createElement("span",{className:"ft-24"},"Or"),React.createElement("br",null),React.createElement("br",null),"Import an existing project",React.createElement("input",{type:"file",ref:this.existingImportInput,accept:".json",onInput:async()=>await this.onExistingImportInput()}))))}}var ImportSelector$1=ImportSelector,home="";function Home(o){const{graphEdges:e,processedSourceMap:n,bundledFilesTransform:r,graphFileTransform:t,history:s}=o;return React.createElement("div",{id:"home"},React.createElement("section",{style:{background:"var(--grey900)",color:"white"}},React.createElement("div",{className:"right-panel"},React.createElement("p",{className:"ft-24"},React.createElement("i",null,"Visualizing what code is in your web bundle, and how it got there.")))),React.createElement("section",{style:{background:"var(--primary-color)",color:"white"}},React.createElement("div",{className:"left-panel"},React.createElement("div",{className:"inner-border vertical-center",style:{borderRight:"3px solid var(--grey300)"}},React.createElement("h2",null,"Step 1"))),React.createElement("div",{className:"right-panel"},React.createElement("p",{className:"ft-18"},"Select the bundler you are using:"),React.createElement(ImportSelector$1,{history:s}))),React.createElement("section",{style:{background:"var(--grey200)",color:"var(--grey900)"}},React.createElement(Switch,null,React.createElement(Route,{path:"/:importer"},React.createElement("div",{className:"left-panel"},React.createElement("div",{className:"inner-border vertical-center",style:{borderRight:"3px solid var(--grey300)"}},React.createElement("h2",null,"Step 2"))))),React.createElement("div",{className:"col-container"},React.createElement("div",{className:"right-col upload"},React.createElement("div",{className:"padding"},React.createElement(Switch,null,React.createElement(Route,{path:"/webpack",component:i=>React.createElement(Importer,{graphFileName:"stats.json",history:i.history,importType:ImportTypes.WEBPACK})}),React.createElement(Route,{path:"/create-react-app",component:i=>React.createElement(Importer,{graphFileName:"stats.json",history:i.history,importType:ImportTypes.CRA})}),React.createElement(Route,{path:"/rollup",component:i=>React.createElement(Importer,{importType:ImportTypes.ROLLUP,graphFileName:"graph.json",history:i.history})}),React.createElement(Route,{path:"/rome",component:i=>React.createElement(Importer,{importType:ImportTypes.ROME,graphFileName:"bundlebuddy.json",history:i.history})}),React.createElement(Route,{path:"/parcel",component:i=>React.createElement(Importer,{importType:ImportTypes.PARCEL,graphFileName:"bundle-buddy.json",history:i.history})}),React.createElement(Route,{path:"/esbuild",component:i=>React.createElement(Importer,{importType:ImportTypes.ESBUILD,graphFileName:"esbuild.json",history:i.history})})))))),e&&React.createElement("section",{style:{color:"var(--grey900)"}},React.createElement("div",{className:"left-panel"},React.createElement("div",{className:"inner-border vertical-center",style:{borderRight:"3px solid var(--grey300)"}},React.createElement("h2",null,"Step 3"))),React.createElement("div",{className:"right-panel"},React.createElement(Resolve$1,{history:s,graphEdges:e,processedBundle:n,sourceMapFileTransform:r,graphFileTransform:t}))))}export{Home as default};
